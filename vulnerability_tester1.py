from vulnerability_scanner import VulnerabilityScanner
import vulnerability_scanner

def main():
    target_url = input("Enter the target URL: ")
    
    scanner = VulnerabilityScanner(target_url)
    
    # Perform vulnerability tests
    tech_stack = scanner.find_tech_stack(target_url)
    scanner.print_tech_stack(tech_stack)
    
    wayback_url = vulnerability_scanner.get_wayback_url(target_url)
    print("Wayback URL:", wayback_url)

    if scanner.check_injection():
        print("Potential injection vulnerability detected")

    if scanner.check_auth_vulnerability():
        print("Potential authentication vulnerability detected")

    if scanner.is_sensitive_data_exposure_vulnerable():
        print("Potential sensitive data exposure vulnerability detected")

    if scanner.check_xxe_vulnerability():
        print("Potential XXE vulnerability detected")

    if scanner.check_broken_excess_control():
        print("Potential broken excess control vulnerability detected")

    if scanner.check_security_misconfiguration():
        print("Potential security misconfiguration detected")

    if scanner.check_cross_site_scripting():
        print("Potential cross-site scripting vulnerability detected")

    if scanner.check_insecure_deserialization():
        print("Potential insecure deserialization vulnerability detected")

    if scanner.check_insufficient_logging_and_monitoring():
        print("Potential insufficient logging and monitoring detected")

    scanner.perform_google_dork()

if __name__ == "__main__":
    main()
